version: 0.0
os: linux

hooks:

  AfterInstall:
    - location: /dev/null
      timeout: 300
      runas: root
      script: |
        aws ecr get-login-password --region us-east-1 | docker login --username AWS --password-stdin 590183786246.dkr.ecr.us-east-1.amazonaws.com
        docker pull 590183786246.dkr.ecr.us-east-1.amazonaws.com/php-app:latest

  ApplicationStart:
    - location: /dev/null
      timeout: 300
      runas: root
      script: |
        docker stop my-container || true
        docker rm my-container || true
        docker run -d --name my-container -p 82:80 590183786246.dkr.ecr.us-east-1.amazonaws.com/php-app:latest
